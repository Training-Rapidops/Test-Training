<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <style>
        * {

            background: #ced4da;
            color: #fff;
        }

        body {
            background: #ced4da;
        }

        h2 {
            margin: 10px auto;
            width: fit-content;
        }

        .container {
            margin: 50px auto;
            font: 24px Arial, sans-serif;
            width: 1050px;
            background: #222;
            padding: 20px;
        }

        .content {
            margin-bottom: 10px;

        }

        #fname,
        #lname,
        .fshow,
        .lshow {
            font: 25px Arial, sans-serif;
            margin: 10px 10px;

        }

        #addbtn,
        #rndata {
            color: blueviolet;
            font-weight: 500;
            /* margin-left: 40px; */
            border: 2px solid blueviolet;
        }

        .editbtn {
            background-color: #49bf21;
            width: 80px;
            margin: 10px;
        }

        .dltbtn {
            background-color: red;
            width: 80px;
            margin: 10px;
        }

        .hidden {
            display: none;
        }
    </style>
    <title>Task 3 - Dynamic Table </title>
</head>

<body>
    <h2>Name Directory</h2>
    <div class="container">
        <input type="text" id="fname" placeholder="First Name" title="First Name">

        <input type="text" id="lname" placeholder="Last Name" title="Last Name">
        <button class="addbtn" id="addbtn" title="Add Values">⊕ Add</button>
        <button class="updtbtn hidden" id="addbtn" title="Update Values">⟲ Update</button>
        <button class="RenderData" id="rndata" title="Rander Stored Data">Render Data</button>

        <script>
            let rnArr = [
                {
                    FirstName: "Safi",
                    LastName: "Shaikh"
                },
                {
                    FirstName: "Deep",
                    LastName: "Parmar"
                },
                {
                    FirstName: "Amit",
                    LastName: "Shah"
                },
                {
                    FirstName: "Siddharth",
                    LastName: "Chaturvedi"
                },
                {
                    FirstName: "Ronak",
                    LastName: "Dave"
                },
                {
                    FirstName: "Nilesh",
                    LastName: "Tank"
                },
                {
                    FirstName: "Yash",
                    LastName: "Patel"
                },
                {
                    FirstName: "Jenish",
                    LastName: "Chauhan"
                },
                {
                    FirstName: "Mita",
                    LastName: "Aggarwal"
                },
                {
                    FirstName: "Yohani",
                    LastName: "Desai"
                }
            ]

            let container = document.querySelector(".container");
            let fname = document.getElementById("fname");
            let lname = document.getElementById("lname");
            let addbtn = document.getElementById("addbtn");
            let updtbtn = document.querySelector(".updtbtn");
            let rndata = document.getElementById('rndata');

            let firstNameArr = [], lastNameArr = [];

            let i = 1;
            addbtn.addEventListener("click", () => { addRow(fname.value, lname.value) });
            rndata.addEventListener("click", RenderData);
            // Adding A row 
            function addRow(fname, lname) {
                if (!firstNameArr.includes(fname) || !lastNameArr.includes(lname)) {

                    let content = document.createElement("div");
                    let fshow = document.createElement("input");
                    let lshow = document.createElement("input");
                    let count = i;
                    fshow.value = fname;
                    lshow.value = lname;

                    firstNameArr.push(fname);
                    lastNameArr.push(lname);

                    content.setAttribute("id", `content${i}`);
                    content.setAttribute("class", `content`);
                    content.setAttribute("title", `Row ${i}`)
                    fshow.setAttribute("id", `fshow${i}`);
                    fshow.setAttribute("class", "fshow");
                    lshow.setAttribute("id", `lshow${i}`);
                    lshow.setAttribute("class", "lshow")

                    container.appendChild(content);
                    content.appendChild(fshow);
                    content.appendChild(lshow);

                    let editbtn = document.createElement("button");
                    let dltbtn = document.createElement("button");

                    editbtn.classList.add("btn", "editbtn");
                    dltbtn.classList.add("btn", "dltbtn");
                    editbtn.innerHTML = "Edit";
                    dltbtn.innerHTML = "Delete"

                    editbtn.setAttribute("id", `editbtn${i}`);
                    dltbtn.setAttribute("id", `dltbtn${i}`)
                    content.appendChild(editbtn);
                    content.appendChild(dltbtn);

                    editbtn.addEventListener("click", editBtn);
                    dltbtn.addEventListener("click", dltBtn);

                    i++;
                    backNormal();
                } else {
                    alert("Duplicate Values Found");
                }

            }
            // Edit Button
            function editBtn() {
                let eventbtn = event.target;
                let regex = /\d+/g;
                let i = eventbtn.getAttribute("id").match(regex).join("");
                console.log(i);
                let fshow = document.getElementById(`fshow${i}`);
                let lshow = document.getElementById(`lshow${i}`);

                document.getElementById("fname").value = `${fshow.value}`;
                document.getElementById("lname").value = `${lshow.value}`;

                updtbtn.classList.remove("hidden");
                addbtn.classList.add("hidden");
                updtbtn.addEventListener("click", function () {
                    fshow.value = `${document.getElementById("fname").value}`;
                    lshow.value = `${document.getElementById("lname").value}`;
                    backNormal();
                });


            }
            // Delete Button
            function dltBtn() {
                let eventbtn = event.target;
                let regEx = /\d+/g;
                let i = eventbtn.getAttribute("id").match(regEx).join("");
                console.log(i);
                let rowRM = document.getElementById(`content${i}`);
                rowRM.remove();
            }
            //Render Stored Array Data
            function RenderData() {
                rnArr.forEach(nameObj => {
                    let { FirstName, LastName } = nameObj;

                    addRow(FirstName, LastName);
                });

            }
            //To get initial state of input fields and buttons
            function backNormal() {
                fname.value = "";
                lname.value = "";

                addbtn.classList.remove("hidden");
                updtbtn.classList.add("hidden");
            }

        </script>
    </div>
</body>

</html>